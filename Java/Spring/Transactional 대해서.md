# #목차
1) []()

<br>
<br>
<br>

# # Transactional 이란?
트랜잭션은 `우리말로 ‘거래’라는 뜻`을 갖고 있으며, 더 이상 쪼갤 수 없는 최소단위의 작업 또는 모두 저장되거나, 아무 것도 저장되지 않거나를 보장한다.

Transactional을 왜 사용하는지 먼저 간단한 예시를 들어보겠다.

🔍 아래 표와 같이 FAMILY라는 테이블에 데이터가 저장되어있고 조회를 할 경우 정확한 데이터가 출력이 되어야합니다.

| id | name | age |
|----|------|-----|
| 1  | 나    | 28  |
| 2  | 아빠   | 55  |
| 3  | 엄마   | 50  |
| 4  | 남동생  | 26  |
| 5  | 여동생  | 25  |
| 6  | 할아버지 | 96  |

🔍 돈거래로 비유를 하면 A씨의 계좌에는 1000원이 있고 B씨 계좌에는 0원이 있다고 가정하자
>  A씨가 B씨에게 1000원을 계좌이체를 했고 B는 1000원을 출금하는 상황이다.
- 아래 이미지와 같이 `이체과정에서 실패`를 했지만 `B씨는 1000원을 출금하여 돈이 복사된` 문제이다. 물론 돈이 생긴 입장에서는 기분이 좋겠지만 나중에 `개발한 개발자는 돈을 물어내야하는 상황`이 온다.  

이런 일이 발생하지 하도록 즉, `조회, 수정, 작성, 삭제가 정확`하게 이루어지는 것을 `보장하기위해 Transactional를 사용`한다.

![A씨](https://user-images.githubusercontent.com/81284265/174919319-47d34104-2750-479c-9a81-cd6f00c42bd2.png)

# #Transactional 특징
트랜잭션의 특징은 크게 4가지로 구분된고 이것을 ACID  
`원자성 (Atomicity` ,   `일관성(Consistency)`,   `독립성(Isolation)`, `지속성(Durability)` 이라고 부른다.


- `원자성` 은 트랜잭션이 데이터베이스에 모두 반영되던가, 아니면 전혀 반영되지 않아야 한다는 것이다.  
 > Transactional은 절대 쪼개지지 않은 단위로 A씨가 B씨에게 이체하고 B씨 통장에 이체한 금액이 있는 것까지가 하나의 단위이므로 이체 하고 이체한 금액이 통장에 입금하는 기능중 하나라도 실패했다면 반영되지 않아야 한다는 것이다


 <br>
 
- `일관성` 은 트랜잭션의 작업 처리 결과가 항상 일관성이 있어야 한다는 것이다.   
> 트랜잭션이 진행되는 동안에 데이터베이스가 변경 되더라도 업데이트된 데이터베이스로 트랜잭션이 진행되는것이 아니라, 처음에 트랜잭션을 진행 하기 위해 참조한 데이터베이스로 진행된다. 이렇게 함으로써 각 사용자는 일관성 있는 데이터를 볼 수 있는 것이다.
 <br>
 
- `독립성` 은 둘 이상의 트랜잭션이 동시에 실행되고 있을 경우 어떤 하나의 트랜잭션이라도, 다른 트랜잭션의 연산에 끼어들 수 없다는 점을 가리킨다.  

 <br>
 
- `지속성` 은 트랜잭션이 성공적으로 완료됬을 경우, 결과는 영구적으로 반영되어야 한다는 점이다.  


# #Transactional의 독립성의 문제점
Transactional의 독립성은  다른 트랜잭션의 연산에 끼어들 수 없다는 점이다.  
하지만 모든 작업에 독립성을 보장해 하나씩 순차적으로 진행하게 된다면 성능 저하가 온다.
그래서 `Transactional은 설정이 정말 중요`하다.

# ##설정1 : Propagation

![화면 캡처 2022-06-22 101346](https://user-images.githubusercontent.com/81284265/174922683-8d1e17c8-8707-4131-b577-2dd68f73fd8c.png)
- Propagation.REQUIRED
Transactional의 default 값이며 새로운 Transactional이 없으면 메소드1이 Transactional1 로 되고 새로운 Transactional2 가 생긴다면 Transactional2는 Transactional1에 참여하게 됩니다. 즉, 두 메소드가 하나의 Transactional로 실행되기 때문에 어느 하나에서 문제가 발생해도 실행했던 메소드가 롤백됩니다.

- Propagation.NOT_SUPPORT
REQUIRED 처럼 실행된 Transactional이 있으면 참여하고 없다면 단독으로 실행됩니다.

- Propagation.MANDATORY
진행되고 있는 Transactional이 있으면 참여하고 없으면 예외가 발생합니다. 즉, 혼자서는 실행할 수 없다.

- Propagation.REQUIRES_NEW






